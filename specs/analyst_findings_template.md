# Analyst Findings Template

This template defines the structure for Power BI analyst findings reports. All sections are optional and should only be included when relevant to the analysis.

## Document Structure

### Problem Statement
[Clear description of the user's request, issue, or requirement that prompted this analysis]

---

## Prerequisites: Project Setup Validation
[Generated by powerbi-verify-pbiproject-folder-setup agent]

This section documents the project format detection, validation, and setup required before analysis can proceed. The command reads these fields to determine workflow progression.

**Validation Date**: [YYYY-MM-DD HH:MM:SS]
**Agent**: powerbi-verify-pbiproject-folder-setup
**Status**: [validated | action_required | error]
**Action Type**: [none | pbix_extraction | pbitools_install | invalid_format | invalid_tmdl_structure | extraction_failed | pbitools_not_found | manual_extraction_pending | pbitools_install_pending]

### Input Format Detection

**Format Detected**: [pbip | pbi-tools | pbix | pbix-extracted-pbitools | unknown]

**Project Path**: `<absolute-path-to-original-input>`

**Original PBIX**: `<path-to-original-pbix>` (if extracted from PBIX, otherwise "N/A")

### Action Required Details
[Only populated when Status = action_required]

**Required Action**: [Description of what user needs to do]

**User Choices Available**: [Y/N/I] or [manual instructions]

**Next Steps**: [What will happen after user responds]

### Extraction Details
[Populated after successful extraction from PBIX]

**Extraction Method**: [none | automatic-pbitools | manual-pending]

**Extraction Status**: [n/a | success | pending]

**Extracted Folder Path**: `<path-to-extracted-folder>`

**pbi-tools Version**: [version number] (if used, otherwise "N/A")

### Project Structure
[Populated after validation succeeds]

**Semantic Model Path**:
- For .pbip: `<project>/<Name>.SemanticModel/definition/`
- For pbi-tools: `<project>/Model/`
- For pbix-extracted-pbitools: `<extracted-folder>/Model/`

**Report Path**:
- For .pbip: `<project>/<Name>.Report/` (if exists, otherwise "N/A")
- For pbi-tools: N/A (pbi-tools format)

**TMDL Structure**: [validated | invalid]
- `model.tmdl`: [Found | Missing]
- `database.tmdl`: [Found | N/A | Missing] (required for pbi-tools format only)
- `tables/` folder: [Found | Missing]
- `relationships.tmdl`: [Found | Not Found]

### Review & Deployment Requirements
[Populated after validation succeeds]

**Can Open in Power BI Desktop**: [Yes - Open .pbip file directly | Requires Compilation]

**Compilation Required for Review**: [false | true]

**Compilation Command** (if required):
```bash
cd "<project-path>"
pbi-tools compile . "output.pbit" PBIT -overwrite
```

**Deployment Format**:
- If .pbip: Can publish directly from Power BI Desktop
- If pbi-tools/pbix-extracted-pbitools: Compile to PBIT, then publish after opening and refreshing

### Metadata
[Critical fields for downstream agents - ALWAYS populated when Status = validated]

**format**: [pbip | pbi-tools | pbix-extracted-pbitools]

**requires_compilation**: [true | false]

**validated_project_path**: `<path-to-use-for-analysis>`
  - This is the path that should be used by all subsequent agents (code-locator, code-fix-identifier, etc.)
  - For .pbip: Same as original project path
  - For pbi-tools: Same as original project path
  - For pbix-extracted-pbitools: Path to extracted folder

### Error Details
[Only populated when Status = error]

**Error Message**: [Clear description of the problem]

**Files Expected**: [What files/folders were expected]

**Files Found**: [What was actually found at the path]

**Suggested Fix**: [How to resolve the issue]

### Notes

[Any additional notes, warnings, or observations about the project setup]

---

## Section 1: Current Implementation Investigation
[Generated by powerbi-code-locator agent]

This section documents the existing code and implementation details relevant to the problem statement.

### [Object Name] - [Object Type]
**Location:** [filename.tmdl](path/to/file.tmdl)

**Current Code:**
```dax
[existing DAX code here]
```

**Description:** [Factual description of what this code does]

---

## Section 2: Proposed Changes
[Generated by powerbi-code-implementer agent or powerbi-artifact-designer agent]

This section documents the recommended code changes and new implementations.

### [Object Name] - [Object Type]
**Change Type:** [MODIFY | CREATE | DELETE]
**Target Location:** [filename.tmdl](path/to/file.tmdl)

**Original Code:** (if modifying existing code - Change Type: MODIFY)
```dax
[existing code here]
```

**Proposed Code:**
```dax
[new/modified code here]
```

**Styling & Metadata:** (optional - include when styling changes or new artifacts)
- **Format String:** `"pattern"` (e.g., `"$#,0.00"` for currency, `"0.0%"` for percentage)
- **Display Folder:** `"folder/path"` (e.g., `"Sales Metrics"`, `"Growth Metrics"`)
- **Description:** `"tooltip text"` (concise explanation shown in tooltips)
- **Data Category:** [None | Email | WebURL | ImageURL | etc.]

**Visual Formatting:** (optional - for visual artifacts only)
- **Font:** [Family, Size, Weight, Color specifications]
- **Colors:** [Background, Foreground, Data color specifications]
- **Conditional Formatting:** [Rules, thresholds, and formatting applied]
- **Border/Layout:** [Border style, padding, alignment specifications]

**Change Rationale:** [Explanation of what changed and why, including performance considerations, best practices applied, styling decisions, and pattern adherence]

**Dependencies:** (optional - document required artifacts)
- [Required measures, columns, tables, or relationships]

**Validation Notes:** (optional - document edge case handling)
- [How edge cases are handled]
- [Performance considerations]

---

## Section 3: Test Cases and Impact Analysis
[Optional section for documenting test scenarios and impact assessment]

### Test Cases

#### Test Case 1: [Test Name]
**Objective:** [What this test verifies]

**Test Steps:**
1. [Step 1]
2. [Step 2]
3. [Step 3]

**Expected Result:** [What should happen]

**Actual Result:** [What actually happened - to be filled during testing]

---

### Impact Analysis

#### Performance Impact
[Assessment of how changes affect query performance, refresh times, model size, etc.]

#### Downstream Dependencies
[Tables, measures, reports, or visualizations affected by these changes]

#### Breaking Changes
[Any changes that might break existing functionality or require updates elsewhere]

#### Data Integrity Considerations
[How changes affect data accuracy, completeness, or consistency]

---

## Section 4: Implementation Notes
[Optional section for additional context, gotchas, or follow-up items]

### Prerequisites
- [Any required setup or configuration before implementing changes]

### Implementation Order
1. [First change to make]
2. [Second change to make]
3. [etc.]

### Post-Implementation Validation
- [ ] [Validation step 1]
- [ ] [Validation step 2]
- [ ] [etc.]

### Known Limitations
[Any limitations or edge cases to be aware of]

### Future Enhancements
[Potential improvements to consider after initial implementation]
